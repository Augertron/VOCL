CCPLUS=mpicxx
CC=gcc
NVCC=nvcc
OBJ=obj
INC=-Iinc -I/usr/local/cuda/include
LIB=-L/home/scxiao/workplace/anl/gpuvirtualization
#LIB=-L/home/shucaixiao/ati-stream-sdk-v2.2-lnx64/lib/x86_64
SRC=src

SRCFILES=$(SRC)/matrixMul.c $(SRC)/timeRec.c

HEADERFILES=$(INC)/functions.h $(INC)/timeRec.h
OBJFILES=$(OBJ)/timeRec.o
CCFLAGS= -c -O3 $(INC)

all: oclMatrixMul

oclMatrixMul: $(OBJFILES) $(OBJ)/matrixMul.o
	$(CCPLUS) -static $(OBJFILES) $(OBJ)/matrixMul.o $(LIB) -lGPUv -o virMatrixMul

$(OBJ)/matrixMul.o: $(SRC)/matrixMul.c
	$(CCPLUS) $(CCFLAGS) -o $(OBJ)/matrixMul.o $(SRC)/matrixMul.c

$(OBJ)/timeRec.o: $(SRC)/timeRec.c
	$(CCPLUS) $(CCFLAGS) -o $(OBJ)/timeRec.o $(SRC)/timeRec.c

clean:
	rm -f oclMatrixMul $(OBJ)/*

